\begin{algorithm}[t]
  \DontPrintSemicolon \KwIn{Initial parameters $\theta_0$, number of negative
    samples $K$, learning rate $\rho$}

  \KwOut{Parameters $\theta$ of the \acrshort{rankfromsets} model that maximize 
    recommendation performance}

  \While{Validation recall improves} {
    Sample a datapoint $(x_m, \yum=1)$ uniformly at random \\
    \For{k from 1 to K}{ Draw negative sample $x_k \sim \textrm{Uniform}(I)$;
      assign $\yuk = 0$ }
    $\theta_{t+1} = \theta_t + \rho\nabla  \cL(\theta, (x_m, \yum), \{(x_k, \yuk)\})$\\

  } \Return{$\theta$}\;
\caption{\textbf{The \acrshort{rankfromsets} algorithm.} The per-datapoint objective
    $\cL$ is defined in \Cref{eq:objective}. }
\label{algo:rankfromsets}
\end{algorithm}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "set_recommendation"
%%% End:
